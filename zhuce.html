<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title></title>
	<link rel="stylesheet" type="text/css" href="css/zhuce.css">
</head>
<body>
	<div class="header">
	<a href="##"><img  src="img/logo2.png" alt=""></a>
	<div class="miniheader_right">
        <span class="right_span">
            <i></i>天天低价
        </span>
        <span class="right_span">
            <i></i>正品保障
        </span>
        <span class="right_span">
            <i></i>15天退换货
        </span>
        <span class="right_span">
            <i></i>评价晒单有礼
        </span>
    </div>
</div>
<a href="##" class=".login_new_bg"><img class="imgs" src="img/da.jpg" alt=""></a>
<div class="loginwarpper">
	<div class="login" style="background-image: none;">
       <div class="loginRightSecond">
			<div class="loginRightSecond-top">
				<h2>欢迎注册</h2>
				<a href="denglu.html">登录</a>
			</div>
			<!-- 账号登陆 -->
			<input id="txtUsername" class="input1" type="text" placeholder=" 请输入手机号"><span style="color: red;" id="userSpan"></span><br>
			<div class="dayanjing">
			<input id="userpass" class="input2" type="password" placeholder=" 请设置密码"><br>
			<span class="yanjing"></span>
			</div>
			<div class="yanzhengma">
				<input class="input4" type="text" placeholder="图形验证码">
				<img src="img/getcode.htm" alt="">
			</div>
			
			<a href="##"><input class="input3" id="btnReg" type="button" value="注册"></a>
			<div id="errorMessage" style="display: none;color:red"></div>

			<a class="wjmm" href="##">注册即视为同意 <span>好乐买隐私协议</span></a>
		
	
		</div>

    </div>
</div>
<div class="minifooter">Copyright © 2007-2019 OkBuy.com All Rights Reserved&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;天津好乐买信息技术有限公司&nbsp;&nbsp;津B2-20140020&nbsp;&nbsp;京公网安备&nbsp;110105006859</div>
</body>
</html>
<script type="text/javascript" src="js/regexpTools.js"></script>
<script type="text/javascript">
	function $(str){
	if(str.charAt(0)=="#"){
		return document.getElementById(str.substring(1));
	}else if(str.charAt(0)=="."){
		return document.getElementsByClassName(str.substring(1));
	}else{
		return document.getElementsByTagName(str);
	}
}
$("#txtUsername").onblur = function(){
		if(regExp1809("phone",this.value)){
			//1、创建对象
			let xhr =new XMLHttpRequest();
			//2、设置请求参数
			xhr.open("get","php/checkuser02.php?username="+this.value,true);
			xhr.onreadystatechange = function(){
			if(xhr.readyState==4 && xhr.status==200){
				if(xhr.responseText=="0"){
					$("#userSpan").innerHTML="亲，该用户已被注册，您还是换一个吧";
				}else{
					$("#userSpan").innerHTML="亲，恭喜您，该用户名可以使用";	
				}				
			}
		}
		xhr.send();
		}else{
			this.nextElementSibling.innerHTML = "请输入11位手机号";
		}
		

		

		
	}

	$("#btnReg").onclick = function(){
		//1、创建对象
		let xhr =new XMLHttpRequest();

		//2、设置请求参数
		xhr.open("post","php/regSave.php",true);

		xhr.onreadystatechange = function(){
			if(xhr.readyState==4 && xhr.status==200){
				if(xhr.responseText=="1"){
					location.href="denglu.html";
				}else{
					$("#errorMessage").innerHTML="注册失败！";
					$("#errorMessage").style.display="block";
				}
			}
		}
		xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");
		let str = `username=${$("#txtUsername").value}&userpass=${$("#userpass").value}`;
		xhr.send(str);
	}


</script>
